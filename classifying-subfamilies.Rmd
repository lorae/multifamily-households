---
title: "classifying-subfamilies"
output: html_document
---

Let's look at some examples.

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  echo = FALSE
)
```

```{r load-data}
# process-ipums-cps.R
#
# This script  reads data from the "ipums-cps" table in `/db/ipums-raw.duckdb` and writes processed
# data to the "ipums-cps-bucketed" table in `/db/ipums-processed.duckdb`.
#
# ----- Step 0: Configuration ----- #
library("dplyr")
library("duckdb")
library("ipumsr")
library("dbplyr")
library("lubridate")

devtools::load_all("../demographr")

```

```{r wrangle-data}
ipums_household <- readRDS("throughput/classifying-subfamilies.rds")
```

```{r define-function}
get_household_tables <- function(hh_id) {
  ipums_household |>
    filter(CPSID == hh_id) |>
    arrange(date) |>
    split(~date)
}

print_household_tables <- function(hh_list, hh_id = NULL) {
  for (d in names(hh_list)) {
    cat("\n\n###", d, "\n\n")
    print(knitr::kable(hh_list[[d]], caption = paste("Household", hh_id, "-", d)))
  }
}

get_hhs <- function(hh_id) {
  get_household_tables(hh_id) |> print_household_tables(hh_id)
}

```
```

Here's 2 parents with 4 young children

```{r results='asis'}
get_hhs(20231100668400)
```
